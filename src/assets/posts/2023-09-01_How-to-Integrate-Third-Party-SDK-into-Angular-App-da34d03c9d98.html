<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>How to Integrate Third-Party SDK into Angular App</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">How to Integrate Third-Party SDK into Angular App</h1>
</header>
<section data-field="subtitle" class="p-summary">
Most widely-used APIs provide comprehensive guides for JavaScript integration into web applications. However, adapting these integrations…
</section>
<section data-field="body" class="e-content">
<section name="a2cb" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d14c" id="d14c" class="graf graf--h3 graf--leading graf--title">How to Integrate Third-Party SDK into Angular App</h3><figure name="5cb9" id="5cb9" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*jVjbovW_bN4U9ytG" data-width="3880" data-height="2910" data-unsplash-photo-id="MOO6k3RaiwE" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*jVjbovW_bN4U9ytG"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@designedbyflores?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@designedbyflores?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Omar Flores</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="3770" id="3770" class="graf graf--p graf-after--figure">Most widely-used APIs provide comprehensive guides for JavaScript integration into web applications. However, adapting these integrations to Angular can sometimes present challenges. In this article, we’ll explore the integration of the Google Calendar API into an Angular application, providing a step-by-step guide for seamless implementation. While the process may involve several components, this article will serve as a concise reference.</p><h4 name="5124" id="5124" class="graf graf--h4 graf-after--p">Introduction</h4><p name="554e" id="554e" class="graf graf--p graf-after--h4">Integrating APIs into web applications is a common practice, yet when it comes to incorporating them into Angular applications, the process can become more intricate. As an illustrative example, we’ll delve into the integration of the Google Calendar API within an Angular context. Although obtaining Google API credentials is a prerequisite (covered in the <a href="https://developers.google.com/calendar/api/quickstart/js" data-href="https://developers.google.com/calendar/api/quickstart/js" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">official JS guide</a>), this article will focus on the integration process itself, specifically emphasizing the dynamic loading of the Google API SDK.</p><h4 name="8148" id="8148" class="graf graf--h4 graf-after--p">Dynamic Loading of Google API SDK</h4><p name="451d" id="451d" class="graf graf--p graf-after--h4">The foundation of our implementation involves creating a custom module to load two essential SDK links before rendering a designated component. The following URLs are crucial for the integration process:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="rust" name="eca8" id="eca8" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">const</span> GOOGLE_CALENDAR_GAPI_SDK = <span class="hljs-symbol">&#x27;https</span>:<span class="hljs-comment">//apis.google.com/js/api.js&#x27;;</span><br /><span class="hljs-keyword">const</span> GOOGLE_CALENDAR_GIS_SDK = <span class="hljs-symbol">&#x27;https</span>:<span class="hljs-comment">//accounts.google.com/gsi/client&#x27;;</span></span></pre><p name="7c55" id="7c55" class="graf graf--p graf-after--pre">To facilitate the dynamic loading, we establish functions for injecting scripts onto the page:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="139d" id="139d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment">// google-factory.ts</span><br /><br /><span class="hljs-keyword">import</span> { <span class="hljs-title class_">InjectionToken</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br /><br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CLIENT_ID</span> = <span class="hljs-string">&#x27;708353567948-kq391iebelqkndr0hir8qijbqtpts3mf.apps.googleusercontent.com&#x27;</span>;<br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_KEY</span> = <span class="hljs-string">&#x27;AIzaSyBEE3-D31HShcqmAdFLbJETznBteI-9xEo&#x27;</span>;<br /><br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DISCOVERY_DOC</span> = <span class="hljs-string">&#x27;https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest&#x27;</span>;<br /><br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SCOPES</span> = <span class="hljs-string">&#x27;https://www.googleapis.com/auth/calendar.readonly&#x27;</span>;<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GOOGLE_CALENDAR_GAPI_INSTANCE</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InjectionToken</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt;(<span class="hljs-string">&#x27;google.calendar.gapi.instance&#x27;</span>);<br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GOOGLE_CALENDAR_GIS_INSTANCE</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InjectionToken</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt;(<span class="hljs-string">&#x27;google.calendar.gis.instance&#x27;</span>);<br /><br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GOOGLE_CALENDAR_GAPI_SDK</span> = <span class="hljs-string">&#x27;https://apis.google.com/js/api.js&#x27;</span>;<br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GOOGLE_CALENDAR_GIS_SDK</span> = <span class="hljs-string">&#x27;https://accounts.google.com/gsi/client&#x27;</span>;<br /><br /><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">google</span>: <span class="hljs-built_in">any</span>;<br /><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">gapi</span>: <span class="hljs-built_in">any</span>;<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getGapi</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">any</span> {<br />    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span> &amp;&amp; (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)?.<span class="hljs-property">gapi</span>) {<br />        gapi.<span class="hljs-title function_">load</span>(<span class="hljs-string">&#x27;client&#x27;</span>, initializeGapiClient);<br />        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span> &amp;&amp; (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">gapi</span>;<br />    }<br />    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br />}<br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getGis</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">any</span> {<br />    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span> &amp;&amp; (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">google</span>) {<br />        <span class="hljs-title function_">gisLoaded</span>();<br />        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span> &amp;&amp; (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">google</span>;<br />    }<br />    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br /><br />}<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadGapiSdk</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt; {<br />    <span class="hljs-keyword">const</span> gapi = <span class="hljs-title function_">getGapi</span>();<br />    <span class="hljs-keyword">return</span> gapi ? <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>( gapi ) : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br />        <span class="hljs-keyword">try</span> {<br />            <span class="hljs-keyword">const</span> <span class="hljs-title function_">findGapiScript</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelector</span>&lt;<span class="hljs-title class_">HTMLScriptElement</span>&gt;(<span class="hljs-string">`script[src^=&quot;<span class="hljs-subst">${GOOGLE_CALENDAR_GAPI_SDK}</span>&quot;]`</span>);<br />            <span class="hljs-keyword">const</span> <span class="hljs-title function_">injectGapiScript</span> = (<span class="hljs-params"></span>) =&gt; {<br /><br />                <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);<br /><br />                script.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">GOOGLE_CALENDAR_GAPI_SDK</span>;<br />                script.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;text/javascript&#x27;</span>;<br />                script.<span class="hljs-property">defer</span> = <span class="hljs-literal">true</span>;<br />                script.<span class="hljs-property">async</span> = <span class="hljs-literal">true</span>;<br />                (<span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>).<span class="hljs-title function_">appendChild</span>(script);<br /><br />                <span class="hljs-keyword">return</span> script;<br />            };<br /><br />            <span class="hljs-keyword">const</span> gapiScript = <span class="hljs-title function_">findGapiScript</span>() || <span class="hljs-title function_">injectGapiScript</span>();<br />            gapiScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Unable to load&quot;</span>) ));<br />            gapiScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>( <span class="hljs-title function_">getGapi</span>() ));<br />        }<br />        <span class="hljs-keyword">catch</span>(e) { <span class="hljs-title function_">reject</span>(e); }<br />    });<br />}<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadGisSdk</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt; {<br />    <span class="hljs-keyword">const</span> gis = <span class="hljs-title function_">getGis</span>();<br />    <span class="hljs-keyword">return</span> gis ? <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>( gis ) : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<br /><br />        <span class="hljs-keyword">try</span> {<br />            <span class="hljs-keyword">const</span> <span class="hljs-title function_">findScript</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelector</span>&lt;<span class="hljs-title class_">HTMLScriptElement</span>&gt;(<span class="hljs-string">`script[src^=&quot;<span class="hljs-subst">${GOOGLE_CALENDAR_GIS_SDK}</span>&quot;]`</span>);<br />            <span class="hljs-keyword">const</span> <span class="hljs-title function_">injectScript</span> = (<span class="hljs-params"></span>) =&gt; {<br /><br />                <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);<br /><br />                script.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">GOOGLE_CALENDAR_GIS_SDK</span>;<br />                script.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;text/javascript&#x27;</span>;<br />                script.<span class="hljs-property">defer</span> = <span class="hljs-literal">true</span>;<br />                script.<span class="hljs-property">async</span> = <span class="hljs-literal">true</span>;<br /><br />                (<span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>).<span class="hljs-title function_">appendChild</span>(script);<br /><br />                <span class="hljs-keyword">return</span> script;<br />            };<br />            <span class="hljs-keyword">const</span> gisScript = <span class="hljs-title function_">findScript</span>() || <span class="hljs-title function_">injectScript</span>();<br />            gisScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Unable to load SDK&quot;</span>) ));<br />            gisScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>( <span class="hljs-title function_">getGis</span>() ));<br />        }<br />        <span class="hljs-keyword">catch</span>(e) { <span class="hljs-title function_">reject</span>(e); }<br />    });<br />}<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initializeGapiClient</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-keyword">await</span> gapi.<span class="hljs-property">client</span>.<span class="hljs-title function_">init</span>({<br />        <span class="hljs-attr">apiKey</span>: <span class="hljs-variable constant_">API_KEY</span>,<br />        <span class="hljs-attr">discoveryDocs</span>: [<span class="hljs-variable constant_">DISCOVERY_DOC</span>],<br />    });<br />}<br /><br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">gisLoaded</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-keyword">return</span> google.<span class="hljs-property">accounts</span>.<span class="hljs-property">oauth2</span>.<span class="hljs-title function_">initTokenClient</span>({<br />        <span class="hljs-attr">client_id</span>: <span class="hljs-variable constant_">CLIENT_ID</span>,<br />        <span class="hljs-attr">scope</span>: <span class="hljs-variable constant_">SCOPES</span>,<br />        <span class="hljs-attr">callback</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br />    });<br />}</span></pre><p name="42e8" id="42e8" class="graf graf--p graf-after--pre">The code above provides utility functions and structures to load the required SDKs, initialize the Google Calendar API client, and set up the Google Identity Services for authentication within an Angular application. The use of promises and asynchronous functions ensures that these operations are performed in a non-blocking manner, enhancing the application’s performance and user experience. Here’s a breakdown of the code:</p><ol class="postList"><li name="d200" id="d200" class="graf graf--li graf-after--p">Injection Tokens: The code creates two <code class="markup--code markup--li-code">InjectionToken</code> instances named <code class="markup--code markup--li-code">GOOGLE_CALENDAR_GAPI_INSTANCE</code> and <code class="markup--code markup--li-code">GOOGLE_CALENDAR_GIS_INSTANCE</code>. These tokens are used to provide instances of the Google Calendar API and Google Identity Services through dependency injection in Angular.</li><li name="1cda" id="1cda" class="graf graf--li graf-after--li">Global Declarations: It uses the <code class="markup--code markup--li-code">declare</code> keyword to let TypeScript know about the global variables <code class="markup--code markup--li-code">google</code> and <code class="markup--code markup--li-code">gapi</code>, which are expected to be available through the Google SDKs.</li><li name="afb2" id="afb2" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">getGapi()</code> and <code class="markup--code markup--li-code">getGis()</code> Functions: These functions are used to check whether the <code class="markup--code markup--li-code">gapi</code> and <code class="markup--code markup--li-code">google</code> objects are available in the global scope. If available, the associated SDKs are initialized, and the corresponding object is returned. Otherwise, it returns <code class="markup--code markup--li-code">false</code>.</li><li name="7f5f" id="7f5f" class="graf graf--li graf-after--li">Google SDK URLs: The code defines URLs for the Google API and Google Identity Services SDKs.</li><li name="1761" id="1761" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">loadGapiSdk()</code> and <code class="markup--code markup--li-code">loadGisSdk()</code> Functions: These functions are responsible for dynamically loading the Google API and Google Identity Services SDKs if they are not already loaded. They return promises that resolve to the respective SDK objects.</li><li name="7cf2" id="7cf2" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">initializeGapiClient()</code> Function: This asynchronous function initializes the Google Calendar API client using the <code class="markup--code markup--li-code">gapi.client.init</code> method. It requires the API key and the discovery document URL.</li><li name="e85a" id="e85a" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">gisLoaded()</code> Function: This function initializes the Google Identity Services token client for authentication. It is called once the Google Identity Services SDK is loaded.</li></ol><h4 name="8924" id="8924" class="graf graf--h4 graf-after--li">Creating the NgModule</h4><p name="0bd3" id="0bd3" class="graf graf--p graf-after--h4">The NgModule acts as a pivotal element in our implementation, encompassing component declarations, exports, and provider configurations. Its purpose is to facilitate the loading of Google API instances via factory functions:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="6678" id="6678" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">import {NgModule} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br />import {<br />  GOOGLE_CALENDAR_GAPI_INSTANCE,<br />  GOOGLE_CALENDAR_GIS_INSTANCE,<br />  loadGapiSdk,<br />  loadGisSdk<br />} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./google-factory&#x27;</span>;<br />import {GoogleCalendarComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../google-calendar.component&#x27;</span>;<br /><br />@<span class="hljs-title function_ invoke__">NgModule</span>({<br />  <span class="hljs-attr">declarations</span>: [ GoogleCalendarComponent ],<br />  <span class="hljs-attr">exports</span>: [ GoogleCalendarComponent],<br />  <span class="hljs-attr">providers</span>: [<br />    {<br />      <span class="hljs-attr">provide</span>: GOOGLE_CALENDAR_GAPI_INSTANCE,<br />      <span class="hljs-attr">useFactory</span>: loadGapiSdk<br />    },<br />    {<br />      <span class="hljs-attr">provide</span>: GOOGLE_CALENDAR_GIS_INSTANCE,<br />      <span class="hljs-attr">useFactory</span>: loadGisSdk<br />    },<br />  ],<br />})<br />export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GoogleCalendarModule</span> </span>{}</span></pre><p name="a43e" id="a43e" class="graf graf--p graf-after--pre">If you want to import the NgModule you can find a solution in this article:</p><div name="5c78" id="5c78" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/@teslenkooleg2017/dynamic-import-ngmodule-angular-13-e7183c6743c6" data-href="https://medium.com/@teslenkooleg2017/dynamic-import-ngmodule-angular-13-e7183c6743c6" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@teslenkooleg2017/dynamic-import-ngmodule-angular-13-e7183c6743c6"><strong class="markup--strong markup--mixtapeEmbed-strong">Dynamic import NgModule in Angular</strong><br><em class="markup--em markup--mixtapeEmbed-em">How to lazy-load NgModule and Component by using routing, everyone knows. But sometimes you need to lazy load NgModule…</em>medium.com</a><a href="https://medium.com/@teslenkooleg2017/dynamic-import-ngmodule-angular-13-e7183c6743c6" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="338c483273a187c3080d6aae1fed5260" data-thumbnail-img-id="1*ZD2yDRxPcuEV_qLtnQskTw.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*ZD2yDRxPcuEV_qLtnQskTw.png);"></a></div><h4 name="d775" id="d775" class="graf graf--h4 graf-after--mixtapeEmbed">Developing the Angular Component</h4><p name="0b52" id="0b52" class="graf graf--p graf-after--h4">The heart of our implementation resides in the GoogleCalendarComponent. This Angular component authenticates with the Google Calendar API, seeks user consent, and retrieves and displays forthcoming events from the user’s primary calendar. Let’s delve into its key elements:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="b7fc" id="b7fc" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Component</span>, <span class="hljs-title class_">Inject</span>, <span class="hljs-title class_">OnInit</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br /><span class="hljs-keyword">import</span> {<span class="hljs-variable constant_">GOOGLE_CALENDAR_GAPI_INSTANCE</span>, <span class="hljs-variable constant_">GOOGLE_CALENDAR_GIS_INSTANCE</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./google/google-factory&quot;</span>;<br /><br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CLIENT_ID</span> = <span class="hljs-string">&#x27;708353567948-kq391iebelqkndr0hir8qijbqtpts3mf.apps.googleusercontent.com&#x27;</span>;<br /><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SCOPES</span> = <span class="hljs-string">&#x27;https://www.googleapis.com/auth/calendar.readonly&#x27;</span>;<br /><span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">google</span>: <span class="hljs-built_in">any</span>;<br /><span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">gapi</span>: <span class="hljs-built_in">any</span>;<br /><span class="hljs-meta">@Component</span>({<br />  <span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;app-google-calendar&#x27;</span>,<br />  <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">&#x27;./google-calendar.component.html&#x27;</span>,<br />  <span class="hljs-attr">styleUrls</span>: [<span class="hljs-string">&#x27;./google-calendar.component.scss&#x27;</span>],<br />})<br /><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GoogleCalendarComponent</span>{<br /><br />   <span class="hljs-attr">tokenClient</span>: <span class="hljs-built_in">any</span>;<br /><br />   <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-meta">@Inject</span>(GOOGLE_CALENDAR_GAPI_INSTANCE) <span class="hljs-keyword">private</span> gapiInstance: <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;,<br />               <span class="hljs-meta">@Inject</span>(GOOGLE_CALENDAR_GIS_INSTANCE) <span class="hljs-keyword">private</span> gisInstance: <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;</span>) {<br />   }<br /><br />  <span class="hljs-title function_">handleAuth</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenClient</span> = (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">google</span>.<span class="hljs-property">accounts</span>.<span class="hljs-property">oauth2</span>.<span class="hljs-title function_">initTokenClient</span>({<br />      <span class="hljs-attr">client_id</span>: <span class="hljs-variable constant_">CLIENT_ID</span>,<br />      <span class="hljs-attr">scope</span>: <span class="hljs-variable constant_">SCOPES</span>,<br />      <span class="hljs-attr">callback</span>: {}, <span class="hljs-comment">// defined later</span><br />    });<br /><br />    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenClient</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (resp) =&gt; {<br />      <span class="hljs-keyword">if</span> (resp.<span class="hljs-property">error</span> !== <span class="hljs-literal">undefined</span>) {<br />        <span class="hljs-keyword">throw</span> (resp);<br />      }<br />      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;authorize_button&#x27;</span>).<span class="hljs-property">innerText</span> = <span class="hljs-string">&#x27;Refresh&#x27;</span>;<br />      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listUpcomingEvents</span>();<br />    };<br />    <span class="hljs-keyword">if</span> ((<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">gapi</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">getToken</span>() === <span class="hljs-literal">null</span>) {<br />      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenClient</span>.<span class="hljs-title function_">requestAccessToken</span>({<span class="hljs-attr">prompt</span>: <span class="hljs-string">&#x27;consent&#x27;</span>});<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenClient</span>.<span class="hljs-title function_">requestAccessToken</span>({<span class="hljs-attr">prompt</span>: <span class="hljs-string">&#x27;&#x27;</span>});<br />    }<br />  }<br />  <span class="hljs-keyword">async</span> <span class="hljs-title function_">listUpcomingEvents</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-keyword">let</span> response;<br />      <span class="hljs-keyword">const</span> request = {<br />        <span class="hljs-string">&#x27;calendarId&#x27;</span>: <span class="hljs-string">&#x27;primary&#x27;</span>,<br />        <span class="hljs-string">&#x27;timeMin&#x27;</span>: (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()).<span class="hljs-title function_">toISOString</span>(),<br />        <span class="hljs-string">&#x27;showDeleted&#x27;</span>: <span class="hljs-literal">false</span>,<br />        <span class="hljs-string">&#x27;singleEvents&#x27;</span>: <span class="hljs-literal">true</span>,<br />        <span class="hljs-string">&#x27;maxResults&#x27;</span>: <span class="hljs-number">10</span>,<br />        <span class="hljs-string">&#x27;orderBy&#x27;</span>: <span class="hljs-string">&#x27;startTime&#x27;</span>,<br />      };<br />      response = <span class="hljs-keyword">await</span> gapi.<span class="hljs-property">client</span>.<span class="hljs-property">calendar</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">list</span>(request);<br /><br />    <span class="hljs-keyword">const</span> events = response.<span class="hljs-property">result</span>.<span class="hljs-property">items</span>;<br />    <span class="hljs-keyword">if</span> (!events || events.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) {<br />      <span class="hljs-keyword">return</span>;<br />    }<br />    <span class="hljs-keyword">const</span> output = events.<span class="hljs-title function_">reduce</span>(<br />        <span class="hljs-function">(<span class="hljs-params">str, event</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${str}</span><span class="hljs-subst">${event.summary}</span> (<span class="hljs-subst">${event.start.dateTime || event.start.date}</span>)\n`</span>,<br />        <span class="hljs-string">&#x27;Events:\n&#x27;</span>);<br />    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;listUpcomingEvents output&#x27;</span>, output);<br />  }<br /><br />}</span></pre><p name="38ea" id="38ea" class="graf graf--p graf-after--pre">Here’s a description of the component’s code:</p><ul class="postList"><li name="9a70" id="9a70" class="graf graf--li graf-after--p">Constants <code class="markup--code markup--li-code">CLIENT_ID</code> and <code class="markup--code markup--li-code">SCOPES</code> define the client ID and scopes required for accessing the Google Calendar API.</li><li name="fbe5" id="fbe5" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">declare</code> statements inform TypeScript about the existence of external global variables <code class="markup--code markup--li-code">google</code> and <code class="markup--code markup--li-code">gapi</code>, which are likely part of the Google API SDK.</li><li name="665a" id="665a" class="graf graf--li graf-after--li">Inside the component class, a property <code class="markup--code markup--li-code">tokenClient</code> is declared to store the OAuth2 token client instance.</li><li name="2efb" id="2efb" class="graf graf--li graf-after--li">The constructor takes two dependencies, <code class="markup--code markup--li-code">gapiInstance</code> and <code class="markup--code markup--li-code">gisInstance</code>, injected using the <code class="markup--code markup--li-code">@Inject</code> decorator with corresponding tokens (<code class="markup--code markup--li-code">GOOGLE_CALENDAR_GAPI_INSTANCE</code> and <code class="markup--code markup--li-code">GOOGLE_CALENDAR_GIS_INSTANCE</code>).</li><li name="3e7c" id="3e7c" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">handleAuth</code> method is defined to initiate the authentication process. It initializes the <code class="markup--code markup--li-code">tokenClient</code> using <code class="markup--code markup--li-code">google.accounts.oauth2.initTokenClient</code>, and sets up a callback function to handle the response. The method also checks if the user is already authenticated (<code class="markup--code markup--li-code">getToken() === null</code>) and prompts for consent if needed.</li><li name="4bba" id="4bba" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">listUpcomingEvents</code> method fetches upcoming events from the user&#39;s primary calendar. It constructs a request object and uses the <code class="markup--code markup--li-code">gapi.client.calendar.events.list</code> method to retrieve the events. The results are processed, and event summaries along with start times are logged to the console.</li></ul><h4 name="1c86" id="1c86" class="graf graf--h4 graf-after--li">Conclusion</h4><p name="bf4a" id="bf4a" class="graf graf--p graf-after--h4">Incorporating APIs into Angular applications necessitates a nuanced approach due to the framework’s architecture. By demonstrating the integration of the Google Calendar API, we’ve showcased a structured methodology for overcoming these challenges. This article has explored dynamic SDK loading, injection tokens for SDK instances, and the creation of a dedicated NgModule. The resultant Angular component effectively interacts with the Google Calendar API, demonstrating the potential of harmonizing external APIs with Angular’s ecosystem.</p><p name="1ed7" id="1ed7" class="graf graf--p graf-after--p">By adapting this approach, developers can navigate the integration of various APIs within Angular applications, fostering a more seamless user experience while harnessing the capabilities of external services.</p><p name="2708" id="2708" class="graf graf--p graf-after--p">Thanks for your attention, if you like this article you can 👏 , follow me, or write a comment. You can also see my previous articles:</p><div name="b2d9" id="b2d9" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://blog.bitsrc.io/best-design-principles-in-angular-d7365922d119" data-href="https://blog.bitsrc.io/best-design-principles-in-angular-d7365922d119" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://blog.bitsrc.io/best-design-principles-in-angular-d7365922d119"><strong class="markup--strong markup--mixtapeEmbed-strong">Best Design Principles in Angular</strong><br><em class="markup--em markup--mixtapeEmbed-em">Part 4: Understanding the Interface Segregation Principle (ISP)</em>blog.bitsrc.io</a><a href="https://blog.bitsrc.io/best-design-principles-in-angular-d7365922d119" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="e82781de20555add3a5a4a9751a40aca" data-thumbnail-img-id="0*hF2w5gDJmKgFY_aq" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*hF2w5gDJmKgFY_aq);"></a></div><div name="ed5e" id="ed5e" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://medium.com/@teslenkooleg2017/automatic-application-deployment-using-bitbucket-pipelines-9fa8680e4371" data-href="https://medium.com/@teslenkooleg2017/automatic-application-deployment-using-bitbucket-pipelines-9fa8680e4371" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@teslenkooleg2017/automatic-application-deployment-using-bitbucket-pipelines-9fa8680e4371"><strong class="markup--strong markup--mixtapeEmbed-strong">Automatic Application Deployment Using Bitbucket Pipelines</strong><br><em class="markup--em markup--mixtapeEmbed-em">If you want to automate your routine working days this article is for you. You can find my experience using Bitbucket…</em>medium.com</a><a href="https://medium.com/@teslenkooleg2017/automatic-application-deployment-using-bitbucket-pipelines-9fa8680e4371" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="2a876a4c51de7aca1b3cefa1b0e02487" data-thumbnail-img-id="1*DodMO9jDtkg3pYO5y1H_ZQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*DodMO9jDtkg3pYO5y1H_ZQ.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@teslenkooleg2017" class="p-author h-card">Oleh Teslenko</a> on <a href="https://medium.com/p/da34d03c9d98"><time class="dt-published" datetime="2023-09-01T06:51:50.128Z">September 1, 2023</time></a>.</p><p><a href="https://medium.com/@teslenkooleg2017/how-to-integrate-third-party-sdk-into-angular-app-da34d03c9d98" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 8, 2024.</p></footer></article></body></html>