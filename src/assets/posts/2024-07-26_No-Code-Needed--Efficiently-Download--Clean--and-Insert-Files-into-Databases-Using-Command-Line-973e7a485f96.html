<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>No Code Needed: Efficiently Download, Clean, and Insert Files into Databases Using Command Line</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">No Code Needed: Efficiently Download, Clean, and Insert Files into Databases Using Command Line</h1>
</header>
<section data-field="subtitle" class="p-summary">
How to write data from large files into a database?
</section>
<section data-field="body" class="e-content">
<section name="7090" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0816" id="0816" class="graf graf--h3 graf--leading graf--title">No Code Needed: Efficiently Download, Clean, and Insert Files into Databases Using Command Line</h3><h4 name="c4b2" id="c4b2" class="graf graf--h4 graf-after--h3 graf--subtitle">How to write data from large files into a database?</h4><figure name="fa40" id="fa40" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="0*jv4P3d1io-PLvT3-" data-width="5402" data-height="3601" data-unsplash-photo-id="dJdcb11aboQ" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*jv4P3d1io-PLvT3-"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@john_matychuk?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@john_matychuk?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">John Matychuk</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="2fcf" id="2fcf" class="graf graf--p graf-after--figure">Although it sounds like a common task for modern developers, I want to show another view on this point. Instead of immediately starting to write code using your favorite language, importing libraries, and “reinventing the wheel”, I suggest thinking about alternative ways and trying to do it by writing none of the lines of code. Let me show how to use only the command line tools for this task. You would be surprised how powerful it could be sometimes.</p><h4 name="569f" id="569f" class="graf graf--h4 graf-after--p">Benefits of Using Command Line for Data Tasks</h4><ol class="postList"><li name="9cc6" id="9cc6" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">Speed and Efficiency</strong>: Command-line tools execute tasks directly and with minimal overhead, often faster than equivalent scripts in Python or JavaScript.</li><li name="3809" id="3809" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Simplicity</strong>: Many command-line commands are concise and straightforward, allowing you to accomplish tasks with minimal code.</li><li name="37a4" id="37a4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Resource Usage</strong>: Command-line tools are lightweight and consume less memory, eliminating the need to manage external libraries and dependencies.</li></ol><h4 name="f9ae" id="f9ae" class="graf graf--h4 graf-after--li"><strong class="markup--strong markup--h4-strong">Download the File</strong></h4><p name="7420" id="7420" class="graf graf--p graf-after--h4">The easiest way to do this is to use the command <code class="markup--code markup--p-code">curl</code>. We use <code class="markup--code markup--p-code">curl</code> to download the file from a specified URL:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="2810" id="2810" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">curl -o output_file.tar.gz <span class="hljs-string">&quot;https://s3.amazonaws.com/&quot;</span></span></pre><p name="6d77" id="6d77" class="graf graf--p graf-after--pre">As <code class="markup--code markup--p-code">curl</code> params, we set <code class="markup--code markup--p-code">-o output_file.tar.gz</code> (specifies the output filename) and URL.</p><h4 name="55cd" id="55cd" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Extract the File</strong></h4><p name="32e1" id="32e1" class="graf graf--p graf-after--h4">We use <code class="markup--code markup--p-code">tar</code> command to extract the file:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="e63f" id="e63f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">tar -xzf output_file.tar.gz</span></pre><p name="6df8" id="6df8" class="graf graf--p graf-after--pre">As <code class="markup--code markup--p-code">tar</code> params, we set <code class="markup--code markup--p-code">-xzf</code> (to extract a gzipped tar file) and the output file path.</p><h4 name="c41d" id="c41d" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">Clean the Data</strong></h4><p name="24df" id="24df" class="graf graf--p graf-after--h4">We use <code class="markup--code markup--p-code">sed</code> (a stream editor) to remove single quotes from the CSV file:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="e552" id="e552" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">sed <span class="hljs-string">&quot;s/&#x27;//g&quot;</span> test.csv &gt; cleaned_test.csv</span></pre><p name="e365" id="e365" class="graf graf--p graf-after--pre">As <code class="markup--code markup--p-code">sed</code> params, we set <code class="markup--code markup--p-code">s/&#39;//g</code> (a regular expression, which you can change for your purpose) command that removes all single quotes from <code class="markup--code markup--p-code">test.csv</code>. As an output file for cleaned data, we use <code class="markup--code markup--p-code">cleaned_test.csv</code>.</p><p name="09ae" id="09ae" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Insert Data into MySQL</strong></p><ol class="postList"><li name="b122" id="b122" class="graf graf--li graf-after--p">The <code class="markup--code markup--li-code">mysql</code> command is used to load data into a MySQL database:</li></ol><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="1b64" id="1b64" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content">mysql <span class="hljs-operator">-</span>u user_name <span class="hljs-operator">-</span>p your_database_name <span class="hljs-operator">-</span>e <span class="hljs-string">&quot;LOAD DATA LOCAL INFILE &#x27;/home/user/cleaned_test.csv&#x27; INTO TABLE test FIELDS TERMINATED BY &#x27;,&#x27; ENCLOSED BY &#x27;<span class="hljs-subst">\&quot;</span>&#x27; LINES TERMINATED BY &#x27;<span class="hljs-subst">\n</span>&#x27; IGNORE 1 ROWS;&quot;</span></span></pre><p name="ebe7" id="ebe7" class="graf graf--p graf-after--pre">Replace <code class="markup--code markup--p-code">user_name</code>, <code class="markup--code markup--p-code">your_database_name</code>, and other placeholders with your MySQL credentials and database details.</p><h3 name="beb4" id="beb4" class="graf graf--h3 graf-after--p">Automation</h3><p name="3422" id="3422" class="graf graf--p graf-after--h3">But how could it work together as well as our hand-made written code? The answer is a <em class="markup--em markup--p-em">Bash (Unix shell)</em>.</p><blockquote name="dad6" id="dad6" class="graf graf--blockquote graf-after--p">As a command processor, Bash operates within a text window where users input commands to execute various tasks. It also supports the execution of commands from files, known as <a href="https://en.wikipedia.org/wiki/Shell_script" data-href="https://en.wikipedia.org/wiki/Shell_script" class="markup--anchor markup--blockquote-anchor" title="Shell script" rel="noopener" target="_blank">shell scripts</a>, facilitating automation — <a href="https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29" data-href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">Wikipedia</a></blockquote><p name="6cfd" id="6cfd" class="graf graf--p graf-after--blockquote">Here’s a full code snippet of the shell script that performs the tasks outlined:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="0c1e" id="0c1e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-meta">#!/bin/bash</span><br /><br /><span class="hljs-comment"># URL of the file to download</span><br />URL=<span class="hljs-string">&quot;https://s3.amazonaws.com/&quot;</span><br /><br /><span class="hljs-comment"># Desired output file name</span><br />OUTPUT_FILE=<span class="hljs-string">&quot;archive.tar.gz&quot;</span><br /><br /><span class="hljs-comment"># Download the file with the specified name</span><br />curl -o <span class="hljs-variable">$OUTPUT_FILE</span> <span class="hljs-string">&quot;<span class="hljs-variable">$URL</span>&quot;</span><br /><br /><span class="hljs-comment"># Extract the file</span><br />tar -xzf <span class="hljs-variable">$OUTPUT_FILE</span><br /><br /><span class="hljs-comment"># Use stream editor to remove single quotes from the file</span><br />sed <span class="hljs-string">&quot;s/&#x27;//g&quot;</span> test.csv &gt; cleaned_test.csv<br /><br /><span class="hljs-comment"># Insert the data into the database CH</span><br />clickhouse-client --host=200.12.12.12 --user=user_name --password=<span class="hljs-string">&#x27;password&#x27;</span> --query=<span class="hljs-string">&quot;INSERT INTO test.test_csv_table FORMAT CSVWithNames&quot;</span> &lt; cleaned_test.csv<br /><br /><span class="hljs-comment"># Insert the data into the database MySQL</span><br />mysql -u user_name -p your_database_name -e <span class="hljs-string">&quot;<br />LOAD DATA LOCAL INFILE &#x27;/home/user/cleaned_test.csv&#x27;<br />INTO TABLE test<br />FIELDS TERMINATED BY &#x27;,&#x27;<br />ENCLOSED BY &#x27;\&quot;&#x27;<br />LINES TERMINATED BY &#x27;\n&#x27;<br />IGNORE 1 ROWS;&quot;</span></span></pre><p name="f012" id="f012" class="graf graf--p graf-after--pre">This shell script provides a straightforward way to automate the process of downloading a file, cleaning its content, and inserting it into the MySQL database. To execute this script run the next commands:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="bf69" id="bf69" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-built_in">chmod</span> +x index.sh<br />./index.sh</span></pre><p name="3685" id="3685" class="graf graf--p graf-after--pre">Useful links:</p><ol class="postList"><li name="5fb9" id="5fb9" class="graf graf--li graf-after--p">My GitHub <a href="https://github.com/TeslenkoOleg/bash-curl-stream-file" data-href="https://github.com/TeslenkoOleg/bash-curl-stream-file" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">repository</a> with the complete script and additional details.</li><li name="eaa0" id="eaa0" class="graf graf--li graf-after--li"><a href="https://en.wikibooks.org/wiki/Bash_Shell_Scripting" data-href="https://en.wikibooks.org/wiki/Bash_Shell_Scripting" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Bash Shell Scripting</a> by Wikibooks Contributors.</li></ol><h4 name="0a5f" id="0a5f" class="graf graf--h4 graf-after--li">Conclusion</h4><p name="7b8a" id="7b8a" class="graf graf--p graf-after--h4 graf--trailing">By leveraging bash scripting and command-line tools, you can efficiently handle tasks like downloading, cleaning, and inserting data into a database without writing a single line of application code. This method not only saves development time but also utilizes the powerful features of Unix-based systems, making your workflow simpler and more efficient. So, the next time you face a similar challenge, consider reaching for your terminal instead of your IDE.</p></div></div></section><section name="1cad" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="b87b" id="b87b" class="graf graf--p graf--leading">Thank you for reading. If you have any questions you can find me on <a href="https://www.linkedin.com/in/oleh-teslenko-720443161/" data-href="https://www.linkedin.com/in/oleh-teslenko-720443161/" class="markup--anchor markup--p-anchor" rel="noopener ugc nofollow noopener" target="_blank">LinkedIn</a>. Feel free to leave comments. You can also read my previous articles:</p><div name="9605" id="9605" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/t-slen/breaking-down-big-data-efficient-search-strategies-for-10-gb-files-2a6f14522853" data-href="https://medium.com/t-slen/breaking-down-big-data-efficient-search-strategies-for-10-gb-files-2a6f14522853" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/t-slen/breaking-down-big-data-efficient-search-strategies-for-10-gb-files-2a6f14522853"><strong class="markup--strong markup--mixtapeEmbed-strong">Breaking Down Big Data: Efficient Search Strategies for 10+GB Files</strong><br><em class="markup--em markup--mixtapeEmbed-em">How to find a unique string in a big-sized file? Imagine that you work at Google and you have a huge data set of unique…</em>medium.com</a><a href="https://medium.com/t-slen/breaking-down-big-data-efficient-search-strategies-for-10-gb-files-2a6f14522853" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="98b73584e74b75065b024c851d62e2f3" data-thumbnail-img-id="0*MvH6f73KgVTOCoKM" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*MvH6f73KgVTOCoKM);"></a></div><div name="91e6" id="91e6" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://levelup.gitconnected.com/avoid-common-mistakes-using-a-docker-container-b661233d3905" data-href="https://levelup.gitconnected.com/avoid-common-mistakes-using-a-docker-container-b661233d3905" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://levelup.gitconnected.com/avoid-common-mistakes-using-a-docker-container-b661233d3905"><strong class="markup--strong markup--mixtapeEmbed-strong">Avoid Common Mistakes Using a Docker Container</strong><br><em class="markup--em markup--mixtapeEmbed-em">Understanding Docker’s core concepts, particularly image creation, container management, and file relationships is…</em>levelup.gitconnected.com</a><a href="https://levelup.gitconnected.com/avoid-common-mistakes-using-a-docker-container-b661233d3905" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="38f943270a42377e7133e27385ba36c6" data-thumbnail-img-id="0*cPfapjQpQOIco7WG" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*cPfapjQpQOIco7WG);"></a></div><div name="2c13" id="2c13" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://levelup.gitconnected.com/handling-100gb-data-in-real-time-with-node-js-and-bloom-filters-in-redis-bdb80746cd96" data-href="https://levelup.gitconnected.com/handling-100gb-data-in-real-time-with-node-js-and-bloom-filters-in-redis-bdb80746cd96" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://levelup.gitconnected.com/handling-100gb-data-in-real-time-with-node-js-and-bloom-filters-in-redis-bdb80746cd96"><strong class="markup--strong markup--mixtapeEmbed-strong">Handling 100GB Data in Real Time with Node.js and Bloom Filters in Redis</strong><br><em class="markup--em markup--mixtapeEmbed-em">Imagine you’re building a system that analyzes sensor data streaming in at 100GB per hour. Traditional methods might…</em>levelup.gitconnected.com</a><a href="https://levelup.gitconnected.com/handling-100gb-data-in-real-time-with-node-js-and-bloom-filters-in-redis-bdb80746cd96" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="b07dbccddff33a3390c8614a00a9ca3c" data-thumbnail-img-id="1*_25Uu6-fkVfSPI5XlI9eHg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*_25Uu6-fkVfSPI5XlI9eHg.jpeg);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@teslenkooleg2017" class="p-author h-card">Oleh Teslenko</a> on <a href="https://medium.com/p/973e7a485f96"><time class="dt-published" datetime="2024-07-26T14:51:36.788Z">July 26, 2024</time></a>.</p><p><a href="https://medium.com/@teslenkooleg2017/no-code-needed-efficiently-download-clean-and-insert-files-into-databases-using-command-line-973e7a485f96" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 8, 2024.</p></footer></article></body></html>